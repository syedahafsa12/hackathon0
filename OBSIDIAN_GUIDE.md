# Obsidian Vault Guide for Mini Hafsa 2.0

## Overview

The Obsidian vault is the "nerve center" of Mini Hafsa. All AI reasoning, approvals, and knowledge are stored as human-readable Markdown files. This enables:

- **Transparency**: See exactly what the AI is thinking and doing
- **Auditability**: Full history of all actions with timestamps
- **Control**: Approve or reject actions by moving files
- **Persistence**: Knowledge survives system restarts

## Vault Location

Default location: `.obsidian-vault/` in the project root

To open in Obsidian:
1. Open Obsidian
2. Click "Open folder as vault"
3. Navigate to `.obsidian-vault/`

## Folder Structure

```
.obsidian-vault/
├── Dashboard.md              # Real-time system state
├── Company_Handbook.md       # AI behavior rules
├── Business_Goals.md         # Objectives and metrics
├── Needs_Action/             # Incoming tasks from watchers
├── In_Progress/              # Tasks being processed
├── Pending_Approval/         # Awaiting human decision
├── Approved/                 # Ready for execution
├── Rejected/                 # User said no
├── Done/                     # Completed actions
├── Plans/                    # Daily priority plans
├── Knowledge_Vault/          # User notes and ideas
├── Briefings/                # Weekly CEO reports, News digests
├── Logs/                     # Daily JSON logs
└── Backups/                  # System backups
```

## File Movement Workflow

### Standard Approval Flow

```
Needs_Action → Pending_Approval → Approved → Done
                     ↓
                  Rejected
```

### How to Approve an Action

1. Open `Pending_Approval/` folder
2. Read the action file (e.g., `EMAIL_john_2024-02-10.md`)
3. If correct: **Drag file to `Approved/` folder**
4. If wrong: **Drag file to `Rejected/` folder**

The system watches the `Approved/` folder and automatically executes approved actions.

### How to Stop a Running Task

1. Find the task file in `In_Progress/` (e.g., `TASK_abc-123.md`)
2. Drag the file to `Rejected/` folder
3. The system will stop execution within 2 seconds

## File Formats

### Action Files (Pending_Approval)

All action files use YAML frontmatter:

```markdown
---
type: email_send
actionId: abc-123-def
userId: dev-user-001
priority: high
status: pending_approval
createdAt: 2024-02-10T14:30:00Z
---

## Action: Send Email

**To:** john@example.com
**Subject:** Project Update

**Body:**
Hi John, here's the update you requested...

## Approval Instructions
- Move this file to `/Approved/` to proceed
- Move to `/Rejected/` to cancel
```

### Priority Plan Files (Plans/)

Generated daily at 6 AM:

```markdown
# Today's Priorities - Saturday, February 10, 2024

---
date: 2024-02-10
generatedAt: 2024-02-10T06:00:00.000Z
totalTasks: 15
estimatedHours: 6
---

## Do Now (Before 12 PM)
- [ ] Submit tax documents (due 2024-02-10)
- [ ] Call client about delay (critical)

## Do Next (Before End of Day)
- [ ] Review Sarah's proposal (high)
- [ ] Finish monthly report

## Can Wait (This Week)
- [ ] Organize photo albums
- [ ] Research CRM tools

## Calendar Today
- 10:00 AM - Team standup (30 min)
- 2:00 PM - Client presentation (60 min)

---
*Generated by Priority Sorter Agent at 6:00 AM*
```

### CEO Briefing Files (Briefings/)

Generated every Sunday at 8 PM:

```markdown
# Monday Morning CEO Briefing
**Week of Feb 4 - Feb 10, 2024**

## Executive Summary
- Strong week with 85% task completion
- One bottleneck in client onboarding

## Key Metrics
- **Tasks Completed:** 17 of 20 (85%)
- **Meeting Hours:** 8 hours (20% of time)
- **Deep Work Hours:** 32 hours (80% of time)

## Bottlenecks
| Task | Expected | Actual | Delay |
|------|----------|--------|-------|
| Client onboarding | 2 days | 7 days | +5 days |

## Upcoming Deadlines
- Project Alpha: Feb 15 (5 days)
- Tax filing: Feb 28 (18 days)

## Proactive Suggestions
### Address Recurring Bottlenecks
Create templates for common processes.

---
*Generated by CEO Briefing Agent on 2024-02-10*
```

### News Digest Files (Briefings/)

```markdown
# News Digest - Saturday, February 10, 2024

## Tech
- OpenAI releases GPT-5 [TechCrunch](https://...)
- Meta layoffs in Reality Labs [Reuters](https://...)

## AI Developments
- DeepMind protein folding [Nature](https://...)
- EU AI regulation passes [BBC](https://...)

## World-Impacting
- Climate summit agreement [AP](https://...)

---
*Fetched at 2:30 PM | Sources: NewsAPI, Curated*
```

### Ralph Loop State Files (In_Progress/)

JSON files tracking multi-step task execution:

```json
{
  "taskId": "abc-123-def",
  "userId": "dev-user-001",
  "prompt": "Research competitors and create spreadsheet",
  "currentIteration": 2,
  "maxIterations": 10,
  "startedAt": "2024-02-10T14:30:00.000Z",
  "lastIterationAt": "2024-02-10T14:31:00.000Z",
  "status": "running",
  "completionPromise": "TASK_COMPLETE",
  "iterations": [
    {
      "number": 1,
      "timestamp": "2024-02-10T14:30:05.000Z",
      "action": "Analyzing requirements",
      "result": "Identified 5 competitor categories",
      "completionCheck": false
    }
  ]
}
```

### Log Files (Logs/)

Daily JSON logs:

```json
[
  {
    "timestamp": "2024-02-10T14:30:00.000Z",
    "level": "info",
    "service": "priority-sorter-agent",
    "action": "generate:start",
    "details": "Starting daily priority generation",
    "metadata": { "userId": "dev-user-001" }
  }
]
```

## Dashboard.md

The Dashboard.md file is auto-updated every 30 seconds with:

```markdown
# Mini Hafsa Dashboard

## System State
- **Last Updated**: 2024-02-10T14:30:00.000Z
- **Active Agents**: 2
- **Pending Approvals**: 3
- **Completed Actions**: 12

## Financial Overview
- **Bank Balance**: $5,234.50
- **Recent Transactions**: None
- **Budget Status**: 45%

## Active Projects
- Project Alpha: active
- Website Redesign: on_hold

## Pending Actions
- Email to john@example.com: pending
- Calendar event: pending

## Recent Activity
- 2024-02-10T14:25:00.000Z: email approved by Human
- 2024-02-10T14:20:00.000Z: task created by TaskAgent

## System Health
- **Database**: connected
- **Obsidian Sync**: active
- **API Connections**: all_connected

## Next Steps
- Review pending approvals
- Check CEO briefing
```

## Company_Handbook.md

Customize AI behavior rules:

```markdown
# Company Handbook - Mini Hafsa AI

## Approval Thresholds
- **Auto-Approve**: Actions under $50 or low-risk operations
- **Group Review**: Actions $50-$500
- **Executive Approval**: Actions over $500

## Communication Style
- **Tone**: Professional yet friendly (Kawaii aesthetic)
- **Response Length**: Concise but complete
- **Format**: Markdown with proper headers

## Business Goals
1. Automate routine tasks
2. Build knowledge base
3. Ensure transparency

## Operational Principles
- Always write reasoning to Markdown before action
- Never execute without explicit approval
- Log all actions with timestamps
```

## Tips for Power Users

### Quick Approval Hotkeys (Obsidian)

Set up custom hotkeys in Obsidian:
- `Cmd+Shift+A`: Move to Approved
- `Cmd+Shift+R`: Move to Rejected

### Graph View

Use Obsidian's graph view to visualize:
- Task dependencies
- Knowledge connections
- Action history

### Search

Use Obsidian's global search (Cmd+Shift+F) to find:
- Past actions: `type: email_send`
- Specific dates: `createdAt: 2024-02-10`
- By priority: `priority: critical`

### Templates

Create templates in `Templates/` folder for:
- Common approval types
- Project notes
- Meeting summaries

## Backup and Sync

### Manual Backup
```bash
cp -r .obsidian-vault/ .obsidian-vault-backup-$(date +%Y%m%d)/
```

### Sync with Git
```bash
cd .obsidian-vault
git add .
git commit -m "Vault backup $(date)"
```

### Obsidian Sync
Use Obsidian Sync for real-time backup across devices.

## Troubleshooting

### Files not appearing
- Check folder permissions
- Restart Obsidian
- Check `Logs/` for errors

### Dashboard not updating
- Verify backend is running
- Check for write permission errors
- Manually refresh: delete and regenerate

### Approval not executing
- Verify file is in `Approved/` (not subdirectory)
- Check file has valid frontmatter
- Review `Logs/` for execution errors
